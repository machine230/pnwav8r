<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Weight & Balance | N7798E - PNWAV8R</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    :root {
      --bg: #f2f2f2;
      --panel: #fff;
      --accent: #003366;
      --primary: #336699;
      --danger: #cc0000;
      --safe: #228B22;
    }
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: var(--bg);
      color: #111;
    }
    header {
      background: var(--primary);
      color: white;
      padding: 1rem;
      text-align: center;
    }
    .container {
      max-width: 1000px;
      margin: 2rem auto;
      background: var(--panel);
      padding: 2rem;
      border-radius: 8px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.08);
    }
    h1, h2 {
      text-align: center;
    }
    .grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 2rem;
    }
    label {
      font-weight: bold;
      display: block;
      margin-bottom: 0.25rem;
    }
    input[type="number"] {
      width: 90%;
      padding: 0.3rem 0.5rem;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 0.95rem;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 2rem;
    }
    th, td {
      padding: 6px;
      border: 1px solid #999;
      text-align: center;
      font-size: 0.95rem;
    }
    .result, .reference, .airdata {
      margin-top: 2rem;
    }
    .warning {
      font-weight: bold;
      text-align: center;
      margin-top: 1rem;
    }
    .safe {
      color: var(--safe);
    }
    .danger {
      color: var(--danger);
    }
    canvas {
      display: none;
    }
    .actions {
      display: flex;
      justify-content: center;
      gap: 1rem;
      margin-top: 2rem;
    }
    button {
      padding: 0.6rem 1.5rem;
      font-size: 1rem;
      border: none;
      border-radius: 4px;
      background: var(--accent);
      color: white;
      cursor: pointer;
    }
    .disclaimer {
      font-size: 0.85rem;
      text-align: center;
      margin-top: 2rem;
      color: #666;
    }
    @media (max-width: 768px) {
      .grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>N7798E Weight & Balance Calculator</h1>
  </header>
  <main class="container">
    <div class="grid">
      <div>
        <label for="front">Front Seats (lbs)</label>
        <input type="number" id="front" placeholder="e.g. 320">
        <label for="fuel">Fuel (usable gallons)</label>
        <input type="number" id="fuel" placeholder="e.g. 22.5">
        <label for="baggage">Baggage Area 1 (max 29 lbs)</label>
        <input type="number" id="baggage" placeholder="e.g. 10">
      </div>
      <div class="result">
        <h2>Calculated Results</h2>
        <table>
          <thead>
            <tr><th>Item</th><th>Weight</th><th>Max</th><th>Δ</th><th>Arm</th><th>Moment</th></tr>
          </thead>
          <tbody id="resultsTable"></tbody>
          <tfoot>
            <tr><th>Total</th><th id="totalWeight">—</th><th></th><th></th><th id="cg">—</th><th id="totalMoment">—</th></tr>
          </tfoot>
        </table>
        <p><strong>Va (maneuvering speed):</strong> <span id="va">—</span> MPH</p>
        <p class="warning" id="warning"></p>
      </div>
    </div>

    <div class="airdata">
      <h2>Airspeed Reference (from POH)</h2>
      <ul>
        <li><strong>Vr (Rotation):</strong> 55 MPH</li>
        <li><strong>Vx (Best Angle of Climb):</strong> 60 MPH</li>
        <li><strong>Vy (Best Rate of Climb):</strong> 71 MPH</li>
        <li><strong>Va (Max at Gross Weight 1500 lbs):</strong> 106 MPH</li>
        <li><strong>Va Formula:</strong> <code>Va = Va_max × √(W / Wmax)</code></li>
      </ul>
    </div>

    <div class="reference">
      <h2>Reference Data</h2>
      <table>
        <caption>Basic Weights (lbs)</caption>
        <thead>
          <tr><th>Empty Weight</th><th>MGTW</th><th>MRW</th><th>MLW</th></tr>
        </thead>
        <tbody>
          <tr><td>1041.5</td><td>1500</td><td>1500</td><td>1500</td></tr>
        </tbody>
      </table>
      <table>
        <caption>CG Limits - Normal Category</caption>
        <tr><th>Up To (lbs)</th><th>Fwd Limit</th><th>Aft Limit</th></tr>
        <tr><td>1250</td><td>32.20</td><td>36.00</td></tr>
        <tr><td>1500</td><td>33.40</td><td>36.00</td></tr>
      </table>
    </div>

    <div class="actions">
      <button onclick="calculate()">Calculate</button>
      <button onclick="window.print()">Print</button>
      <button onclick="location.reload()">Reset</button>
    </div>

    <div class="disclaimer">
      This tool is for N7798E only. Always verify final W&amp;B using the official POH before flight.
    </div>
  </main>

  <script>
    const EMPTY_WEIGHT = 1041.5, EMPTY_ARM = 31.78, MAX_TAKEOFF_WEIGHT = 1500;
    const arms = { front: 39.11, fuel: 42.22, baggage: 65.51 };
    function calculate() {
      const front = parseFloat(document.getElementById('front').value) || 0;
      const fuelGal = parseFloat(document.getElementById('fuel').value) || 0;
      const baggage = parseFloat(document.getElementById('baggage').value) || 0;
      const fuel = fuelGal * 6;
      const warningBox = document.getElementById('warning');
      if (baggage > 29) {
        warningBox.innerText = "Baggage exceeds max (29 lbs)";
        warningBox.className = "warning danger";
        return;
      }
      const rows = [
        { name: "Empty Weight", weight: EMPTY_WEIGHT, max: 1500, arm: EMPTY_ARM },
        { name: "Front Seats", weight: front, max: 340, arm: arms.front },
        { name: "Fuel", weight: fuel, max: 135, arm: arms.fuel },
        { name: "Baggage 1", weight: baggage, max: 29, arm: arms.baggage },
      ];
      let totalWeight = 0, totalMoment = 0;
      const resultHTML = rows.map(row => {
        const moment = row.weight * row.arm;
        totalWeight += row.weight;
        totalMoment += moment;
        const delta = row.max - row.weight;
        return `<tr><td>${row.name}</td><td>${row.weight.toFixed(1)}</td><td>${row.max}</td><td>${delta.toFixed(1)}</td><td>${row.arm.toFixed(2)}</td><td>${moment.toFixed(0)}</td></tr>`;
      }).join('');
      const cg = totalMoment / totalWeight;
      const va = Math.round(Math.sqrt(totalWeight / MAX_TAKEOFF_WEIGHT) * 106);
      document.getElementById('resultsTable').innerHTML = resultHTML;
      document.getElementById('totalWeight').innerText = totalWeight.toFixed(1);
      document.getElementById('cg').innerText = cg.toFixed(2);
      document.getElementById('totalMoment').innerText = totalMoment.toFixed(0);
      document.getElementById('va').innerText = va + " MPH";
      const limitsStatus = checkLimits(totalWeight, cg);
      warningBox.innerText = limitsStatus.message;
      warningBox.className = `warning ${limitsStatus.status}`;
    }
    function checkLimits(weight, cg) {
      if (weight > 1500) return { message: "Aircraft is over max gross weight.", status: "danger" };
      const fwd = weight <= 1250 ? 32.20 : 33.40, aft = 36.00;
      if (cg < fwd) return { message: "CG is forward of limit.", status: "danger" };
      if (cg > aft) return { message: "CG is aft of limit.", status: "danger" };
      return { message: "✔ Weight and CG are within limits for the Normal category.", status: "safe" };
    }
  </script>
</body>
</html>
