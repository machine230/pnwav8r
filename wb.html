<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>N7798E Weight & Balance - PNWAV8R</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        .wb-calculator { background: rgba(255, 255, 255, 0.95); border-radius: 15px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); overflow: hidden; margin-bottom: 40px; }
        .wb-header { background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%); color: white; padding: 30px; text-align: center; }
        .wb-content { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; padding: 30px; }
        .input-section { background: #f8f9fa; padding: 25px; border-radius: 10px; border: 2px solid #e9ecef; }
        .results-section { background: #fff; padding: 25px; border-radius: 10px; border: 2px solid #dee2e6; }
        .input-group { margin-bottom: 20px; }
        .input-group label { display: block; margin-bottom: 8px; font-weight: 500; color: #34495e; }
        .input-group input { width: 100%; padding: 12px; border: 2px solid #bdc3c7; border-radius: 8px; font-size: 16px; box-sizing: border-box; }
        .input-group small { color: #7f8c8d; font-size: 12px; }
        .results-table { width: 100%; border-collapse: collapse; margin-bottom: 20px; background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .results-table th, .results-table td { padding: 12px; text-align: left; border-bottom: 1px solid #ecf0f1; }
        .results-table th { background: #34495e; color: white; font-weight: 600; }
        .results-table tr:nth-child(even) { background: #f8f9fa; }
        .total-row { font-weight: bold; background: #e8f4f8 !important; border-top: 2px solid #3498db; }
        .status { padding: 15px; border-radius: 8px; margin: 15px 0; font-weight: 600; text-align: center; }
        .status.safe { background: #d4edda; color: #155724; border: 2px solid #c3e6cb; }
        .status.warning { background: #fff3cd; color: #856404; border: 2px solid #ffeaa7; }
        .status.danger { background: #f8d7da; color: #721c24; border: 2px solid #f5c6cb; }
        .button-group { display: flex; gap: 10px; margin-top: 20px; }
        .calc-button, .print-button { flex: 1; padding: 15px; border: none; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer; }
        .calc-button { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; }
        .print-button { background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color: white; }
        
        /* CG Scale Styles */
        .cg-section { background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #28a745; }
        .cg-scale-container { margin: 20px 0; }
        .cg-scale { position: relative; height: 40px; border-radius: 20px; overflow: hidden; margin-bottom: 15px; box-shadow: inset 0 2px 4px rgba(0,0,0,0.1); background: linear-gradient(90deg, #e74c3c 0%, #e74c3c 15%, #27ae60 15%, #27ae60 85%, #e74c3c 85%, #e74c3c 100%); }
        .safe-zone { position: absolute; left: 15%; width: 70%; height: 100%; background: linear-gradient(90deg, #f39c12 0%, #27ae60 20%, #27ae60 80%, #f39c12 100%); }
        .cg-indicator { position: absolute; top: -15px; height: 70px; width: 6px; background: #2c3e50; border: 3px solid #fff; border-radius: 3px; box-shadow: 0 0 10px rgba(0,0,0,0.3), 0 0 20px rgba(44,62,80,0.5); transition: left 0.3s ease; z-index: 15; }
        .cg-pointer { position: absolute; top: -5px; left: -12px; width: 0; height: 0; border-left: 15px solid transparent; border-right: 15px solid transparent; border-top: 20px solid #2c3e50; filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3)); }
        .cg-pointer::after { content: ''; position: absolute; top: 20px; left: -3px; width: 6px; height: 35px; background: #2c3e50; border: 3px solid #fff; border-top: none; box-shadow: 0 2px 8px rgba(0,0,0,0.2); }
        .cg-value { position: absolute; top: 60px; left: -25px; background: #2c3e50; color: white; padding: 6px 10px; border-radius: 6px; font-size: 13px; font-weight: bold; white-space: nowrap; border: 2px solid #fff; box-shadow: 0 2px 8px rgba(0,0,0,0.2); }
        .scale-labels { display: flex; justify-content: space-between; font-size: 12px; color: #7f8c8d; margin-top: 5px; }
        
        /* Flight Characteristics */
        .flight-characteristics { margin: 20px 0; padding: 15px; border-radius: 8px; }
        .char-normal { background: #d4edda; border-left: 4px solid #28a745; }
        .char-caution { background: #fff3cd; border-left: 4px solid #ffc107; }
        .char-danger { background: #f8d7da; border-left: 4px solid #dc3545; }
        .flight-characteristics h4 { margin-top: 0; margin-bottom: 10px; }
        .flight-characteristics p { margin: 0; line-height: 1.4; }
        
        @media (max-width: 768px) { .wb-content { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <a href="index.html" class="logo">PNWAV8R</a>
            <ul class="nav-menu">
                <li><a href="index.html" class="nav-link">Home</a></li>
                <li><a href="weather.html" class="nav-link">Weather</a></li>
                <li><a href="weight-balance.html" class="nav-link active">Weight & Balance</a></li>
            </ul>
        </div>
    </nav>

    <div class="main-content">
        <div class="wb-calculator">
            <div class="wb-header">
                <h1>N7798E</h1>
                <p>Cessna 150 Weight & Balance Calculator</p>
            </div>
            
            <div class="wb-content">
                <div class="input-section">
                    <h2>Loading Configuration</h2>
                    
                    <div class="input-group">
                        <label for="pilot-weight">Pilot + Co-Pilot (lbs)</label>
                        <input type="number" id="pilot-weight" value="340" min="0" max="400">
                        <small>Station: 32.0" | Max: ~400 lbs total</small>
                    </div>
                    
                    <div class="input-group">
                        <label for="baggage-weight">Baggage (lbs)</label>
                        <input type="number" id="baggage-weight" value="0" min="0" max="120">
                        <small>Station: 95.0" | Max: 120 lbs</small>
                    </div>
                    
                    <div class="input-group">
                        <label for="fuel-gallons">Fuel (gallons)</label>
                        <input type="number" id="fuel-gallons" value="22" min="0" max="22" step="0.1">
                        <small>Max: 22 gal | Weight: <span id="fuel-weight-display">132.0 lbs</span> (6 lbs/gal)</small>
                    </div>
                    
                    <div class="button-group">
                        <button class="calc-button" onclick="calculate()">Calculate W&B</button>
                        <button class="print-button" onclick="window.print()">Print Sheet</button>
                    </div>
                </div>
                
                <div class="results-section">
                    <h2>Results</h2>
                    
                    <table class="results-table">
                        <thead>
                            <tr>
                                <th>Item</th>
                                <th>Weight (lbs)</th>
                                <th>Arm (in)</th>
                                <th>Moment (in-lbs)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Empty Weight</td>
                                <td>1049.2</td>
                                <td>33.23</td>
                                <td>34865.5</td>
                            </tr>
                            <tr>
                                <td>Pilot + Co-Pilot</td>
                                <td id="pilot-display">340</td>
                                <td>32.0</td>
                                <td id="pilot-moment">10880</td>
                            </tr>
                            <tr>
                                <td>Baggage</td>
                                <td id="baggage-display">0</td>
                                <td>95.0</td>
                                <td id="baggage-moment">0</td>
                            </tr>
                            <tr>
                                <td>Fuel</td>
                                <td id="fuel-display">132.0</td>
                                <td>31.0</td>
                                <td id="fuel-moment">4092</td>
                            </tr>
                            <tr class="total-row">
                                <td><strong>TOTAL</strong></td>
                                <td id="total-weight"><strong>1521.2</strong></td>
                                <td id="total-cg"><strong>33.28</strong></td>
                                <td id="total-moment"><strong>49837.5</strong></td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <div id="status" class="status danger">OVERWEIGHT</div>
                    
                    <div class="cg-section">
                        <h4>Center of Gravity Position</h4>
                        <div class="cg-scale-container">
                            <div class="cg-scale">
                                <div class="safe-zone" id="safe-zone"></div>
                                <div class="cg-indicator" id="cg-indicator">
                                    <div class="cg-pointer"></div>
                                    <span class="cg-value" id="cg-value">33.28"</span>
                                </div>
                            </div>
                            <div class="scale-labels">
                                <span id="forward-label">32.20"</span>
                                <span>34.00"</span>
                                <span id="aft-label">36.00"</span>
                            </div>
                        </div>
                        <p id="cg-limits"><strong>CG Limits:</strong> Forward: 32.96" | Aft: 36.00"</p>
                        <p id="cg-margin">Margin from limits will be calculated</p>
                    </div>
                    
                    <div id="flight-characteristics" class="flight-characteristics char-normal">
                        <h4>Normal CG Range</h4>
                        <p>Aircraft exhibits normal flight characteristics with predictable handling qualities.</p>
                    </div>
                    
                    <div style="background: #e3f2fd; padding: 15px; border-radius: 8px; margin-top: 15px; border-left: 4px solid #2196f3;">
                        <h4 style="margin-top: 0; color: #1565c0;">Maneuvering Speed (Va)</h4>
                        <p id="va-speed" style="margin: 5px 0;"><strong>107 MPH</strong></p>
                        <p style="margin: 0;"><small>Va = 106 × √(Weight / 1500)</small></p>
                    </div>
                </div>
            </div>
        </div>
        
        <div style="background: #fff3cd; border: 2px solid #ffc107; border-radius: 8px; padding: 20px; margin: 20px 0;">
            <h4 style="margin-top: 0; color: #856404;">⚠️ IMPORTANT DISCLAIMER</h4>
            <p style="color: #856404;"><strong>This calculator is designed specifically for 1959-1960 Cessna 150 aircraft.</strong></p>
            <p style="color: #856404;">Always verify all calculations against your aircraft's official POH and current W&B documentation. The pilot in command is solely responsible for ensuring the aircraft is loaded within approved limits before flight.</p>
        </div>
    </div>

    <script>
        function interpolateCGLimits(weight) {
            if (weight <= 1250) {
                return { forward: 32.20, aft: 36.00 };
            } else if (weight >= 1500) {
                return { forward: 33.40, aft: 36.00 };
            } else {
                const ratio = (weight - 1250) / (1500 - 1250);
                const forward = 32.20 + ratio * (33.40 - 32.20);
                return { forward: forward, aft: 36.00 };
            }
        }
        
        function calculate() {
            const pilotWeight = parseFloat(document.getElementById('pilot-weight').value) || 0;
            const baggageWeight = parseFloat(document.getElementById('baggage-weight').value) || 0;
            const fuelGallons = parseFloat(document.getElementById('fuel-gallons').value) || 0;
            
            const fuelWeight = fuelGallons * 6.0;
            document.getElementById('fuel-weight-display').textContent = fuelWeight.toFixed(1) + ' lbs';
            
            const emptyWeight = 1049.2;
            const emptyMoment = 34865.5;
            const pilotArm = 32.0;
            const baggageArm = 95.0;
            const fuelArm = 31.0;
            
            const pilotMoment = pilotWeight * pilotArm;
            const baggageMoment = baggageWeight * baggageArm;
            const fuelMoment = fuelWeight * fuelArm;
            
            const totalWeight = emptyWeight + pilotWeight + baggageWeight + fuelWeight;
            const totalMoment = emptyMoment + pilotMoment + baggageMoment + fuelMoment;
            const totalCG = totalMoment / totalWeight;
            
            // Update display
            document.getElementById('pilot-display').textContent = pilotWeight;
            document.getElementById('baggage-display').textContent = baggageWeight;
            document.getElementById('fuel-display').textContent = fuelWeight.toFixed(1);
            document.getElementById('pilot-moment').textContent = pilotMoment.toFixed(0);
            document.getElementById('baggage-moment').textContent = baggageMoment.toFixed(0);
            document.getElementById('fuel-moment').textContent = fuelMoment.toFixed(0);
            document.getElementById('total-weight').innerHTML = '<strong>' + totalWeight.toFixed(1) + '</strong>';
            document.getElementById('total-cg').innerHTML = '<strong>' + totalCG.toFixed(2) + '</strong>';
            document.getElementById('total-moment').innerHTML = '<strong>' + totalMoment.toFixed(0) + '</strong>';
            
            // Get CG limits for current weight
            const cgLimits = interpolateCGLimits(totalWeight);
            
            // Update CG scale
            updateCGScale(totalCG, cgLimits);
            
            // Update status
            updateStatus(totalWeight, totalCG, cgLimits, baggageWeight, fuelGallons);
            
            // Update flight characteristics
            updateFlightCharacteristics(totalCG, cgLimits);
            
            // Calculate Va
            const vaMax = 106;
            const currentVa = vaMax * Math.sqrt(totalWeight / 1500);
            document.getElementById('va-speed').innerHTML = '<strong>' + currentVa.toFixed(0) + ' MPH</strong>';
        }
        
        function updateCGScale(currentCG, cgLimits) {
            const scaleMin = 31.0;
            const scaleMax = 37.0;
            const scaleRange = scaleMax - scaleMin;
            
            const cgPercent = ((currentCG - scaleMin) / scaleRange) * 100;
            const forwardLimitPercent = ((cgLimits.forward - scaleMin) / scaleRange) * 100;
            const aftLimitPercent = ((cgLimits.aft - scaleMin) / scaleRange) * 100;
            
            const indicator = document.getElementById('cg-indicator');
            indicator.style.left = cgPercent + '%';
            document.getElementById('cg-value').textContent = currentCG.toFixed(2) + '"';
            
            const safeZone = document.getElementById('safe-zone');
            safeZone.style.left = forwardLimitPercent + '%';
            safeZone.style.width = (aftLimitPercent - forwardLimitPercent) + '%';
            
            document.getElementById('forward-label').textContent = cgLimits.forward.toFixed(2) + '"';
            document.getElementById('aft-label').textContent = cgLimits.aft.toFixed(2) + '"';
            
            document.getElementById('cg-limits').innerHTML = 
                '<strong>CG Limits:</strong> Forward: ' + cgLimits.forward.toFixed(2) + '" | Aft: ' + cgLimits.aft.toFixed(2) + '"';
            
            const marginFromForward = currentCG - cgLimits.forward;
            const marginFromAft = cgLimits.aft - currentCG;
            document.getElementById('cg-margin').textContent = 
                marginFromForward.toFixed(2) + '" from forward, ' + marginFromAft.toFixed(2) + '" from aft';
            
            // Color the indicator
            const cgPointer = document.querySelector('.cg-pointer');
            const cgValue = document.querySelector('.cg-value');
            
            if (currentCG < cgLimits.forward || currentCG > cgLimits.aft) {
                indicator.style.background = '#e74c3c';
                cgPointer.style.borderTopColor = '#e74c3c';
                cgValue.style.background = '#e74c3c';
            } else if (Math.abs(currentCG - cgLimits.forward) < 0.5 || Math.abs(currentCG - cgLimits.aft) < 0.5) {
                indicator.style.background = '#f39c12';
                cgPointer.style.borderTopColor = '#f39c12';
                cgValue.style.background = '#f39c12';
            } else {
                indicator.style.background = '#2c3e50';
                cgPointer.style.borderTopColor = '#2c3e50';
                cgValue.style.background = '#2c3e50';
            }
        }
        
        function updateStatus(weight, cg, cgLimits, baggage, fuelGallons) {
            const statusElement = document.getElementById('status');
            
            if (weight > 1500) {
                statusElement.className = 'status danger';
                statusElement.textContent = 'OVERWEIGHT - Reduce by ' + (weight - 1500).toFixed(1) + ' lbs';
            } else if (baggage > 120) {
                statusElement.className = 'status danger';
                statusElement.textContent = 'BAGGAGE OVERWEIGHT - Max 120 lbs';
            } else if (fuelGallons > 22) {
                statusElement.className = 'status danger';
                statusElement.textContent = 'FUEL OVERWEIGHT - Max 22 gallons';
            } else if (cg < cgLimits.forward) {
                statusElement.className = 'status danger';
                statusElement.textContent = 'CG TOO FORWARD - ' + (cgLimits.forward - cg).toFixed(2) + '" beyond limit';
            } else if (cg > cgLimits.aft) {
                statusElement.className = 'status danger';
                statusElement.textContent = 'CG TOO AFT - ' + (cg - cgLimits.aft).toFixed(2) + '" beyond limit';
            } else if (weight > 1450 || Math.abs(cg - cgLimits.forward) < 0.5 || Math.abs(cg - cgLimits.aft) < 0.5) {
                statusElement.className = 'status warning';
                statusElement.textContent = 'APPROACHING LIMITS - Use caution';
            } else {
                statusElement.className = 'status safe';
                statusElement.textContent = 'WITHIN LIMITS - Safe for flight';
            }
        }
        
        function updateFlightCharacteristics(cg, cgLimits) {
            const characteristicsElement = document.getElementById('flight-characteristics');
            const cgRange = cgLimits.aft - cgLimits.forward;
            const cgPosition = (cg - cgLimits.forward) / cgRange;
            
            if (cg < cgLimits.forward) {
                characteristicsElement.className = 'flight-characteristics char-danger';
                characteristicsElement.innerHTML = 
                    '<h4>FORWARD CG - DANGEROUS</h4>' +
                    '<p>Heavy nose-down forces, difficulty flaring for landing, potential inability to recover from stall. DO NOT FLY.</p>';
            } else if (cg > cgLimits.aft) {
                characteristicsElement.className = 'flight-characteristics char-danger';
                characteristicsElement.innerHTML = 
                    '<h4>AFT CG - DANGEROUS</h4>' +
                    '<p>Light elevator forces, tendency to pitch up, difficult stall/spin recovery, reduced stability. DO NOT FLY.</p>';
            } else if (cgPosition < 0.3) {
                characteristicsElement.className = 'flight-characteristics char-caution';
                characteristicsElement.innerHTML = 
                    '<h4>Forward CG - Within Limits</h4>' +
                    '<p>Heavier elevator forces, more stable in cruise, higher approach speeds may be needed, requires more back pressure during flare.</p>';
            } else if (cgPosition > 0.7) {
                characteristicsElement.className = 'flight-characteristics char-caution';
                characteristicsElement.innerHTML = 
                    '<h4>Aft CG - Within Limits</h4>' +
                    '<p>Lighter elevator forces, less stable in cruise, reduced stall warning, more sensitive to elevator inputs.</p>';
            } else {
                characteristicsElement.className = 'flight-characteristics char-normal';
                characteristicsElement.innerHTML = 
                    '<h4>Normal CG Range</h4>' +
                    '<p>Aircraft exhibits normal flight characteristics with predictable handling qualities and standard techniques.</p>';
            }
        }
        
        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            const inputs = document.querySelectorAll('input[type="number"]');
            inputs.forEach(input => {
                input.addEventListener('input', calculate);
            });
            calculate();
        });
    </script>
</body>
</html>